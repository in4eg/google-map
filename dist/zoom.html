<!DOCTYPE html>
<html>
<head>
	<title>Simple click event</title>
	<meta name="viewport" content="initial-scale=1.0, user-scalable=no">
	<meta charset="utf-8">

	<link rel="stylesheet" href="css/skin.css">

</head>
<body>
	<button class="btn" id="btn">zoom</button>

	<div id="map2" class="map" data-zoom="18"></div>

	<!-- jquery -->
	<script src="https://code.jquery.com/jquery-2.2.4.js" integrity="sha256-iT6Q9iMJYuQiMWNd9lDyBUStIq/8PuOW33aOqmvFpqI=" crossorigin="anonymous"></script>
	<!-- map -->
	<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCpKZxw5kh0YQOr9lc_2iUE7wnqd8dQYQY&libraries=places"></script>

	<script>
		$(document).ready(function () {
			google.maps.event.addDomListener(window, 'load', initMap);
		});

		var initMap;

		if (document.getElementById('map2')) {
			initMap = function() {
				var i, map, myLatlng, smoothZoom, time, zoom;
				myLatlng = {
					lat: 59.9342802,
					lng: 30.3350986
				};
				map = new google.maps.Map(document.getElementById('map'), {
					zoom: 8,
					mapTypeId: 'satellite',
					scrollwheel: false,
					center: myLatlng
				});
				i = map.getZoom();
				zoom = $('#map').data('zoom');
				time = 80;


				$('#btn').click()

				smoothZoom = (function(_this) {
					return function(map, max, cnt) {
						var marker, z;
						if (cnt >= max) {
							marker = new google.maps.Marker({
								position: myLatlng,
								map: map,
								icon: 'img/map-marker.png',
								title: 'St.Peterburg'
							});
							return;
						} else {
							z = google.maps.event.addListener(map, 'zoom_changed', function(event) {
								google.maps.event.removeListener(z);
								smoothZoom(map, max, cnt + 1);
							});
							setTimeout((function() {
								map.setZoom(cnt);
							}), time);
						}
					};
				})(this);
				smoothZoom(map, zoom, map.getZoom());
			};
		}


	</script>

	<script src="js/bundle.js"></script>

</body>
</html>